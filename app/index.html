<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="A front-end template that helps you build fast, modern mobile web apps.">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <title>FAERUN</title>
    <!-- Add to homescreen for Chrome on Android -->
    <!-- <meta name="mobile-web-app-capable" content="yes"> -->
    <!-- <link rel="icon" sizes="192x192" href="images/android-desktop.png"> -->
    <!-- Add to homescreen for Safari on iOS -->
    <!-- <meta name="apple-mobile-web-app-capable" content="yes"> -->
    <!-- <meta name="apple-mobile-web-app-status-bar-style" content="black"> -->
    <!-- <meta name="apple-mobile-web-app-title" content="Faerun"> -->
    <!-- <link rel="apple-touch-icon-precomposed" href="images/ios-desktop.png"> -->
    <!-- Tile icon for Win8 (144x144 + tile color) -->
    <!-- <meta name="msapplication-TileImage" content="images/touch/ms-touch-icon-144x144-precomposed.png"> -->
    <!-- <meta name="msapplication-TileColor" content="#3372DF"> -->
    <link rel="shortcut icon" href="images/favicon.ico">
    <!-- SEO: If your mobile URL is different from the desktop URL, add a canonical link to the desktop page https://developers.google.com/webmasters/smartphone-sites/feature-phones -->
    <!--
        <link rel="canonical" href="http://www.example.com/">
        -->
    <script src="libs/socketio/socket.io-1.4.5.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="libs/saveAsPolyfill/FileSaver.min.js"></script>
    <script src="https://unpkg.com/lore-engine@1.0.24/dist/lore.min.js"></script>
    <script src="https://unpkg.com/smiles-drawer@1.0.8/dist/smiles-drawer.min.js"></script>
    <script src="libs/handlebars/handlebars-v4.0.5.js"></script>
    <script src="libs/firstimpression/firstimpression.min.js"></script>

    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css?family=Roboto:regular,bold,italic,thin,light,bolditalic,black,medium&amp;lang=en">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Mono:300,400,500,700">
    <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/dialog-polyfill/0.4.6/dialog-polyfill.min.css" />

    <link rel="stylesheet" href="styles/materialize/materialize.css">
    <link rel="stylesheet" href="styles/index.css">
</head>

<body>
    <!-- The slide-out menu -->
    <div id="slide-out" class="sidenav">
        <p class="faerun-controls-header"><i class="material-icons">open_in_browser</i><span>DATA</span></p>
        <div class="input-field select">
            <select id="select-database" data-binding-id="selectDatabase" name="select-database">
                <option value=""></option>
            </select>
            <label for="select-database">Database</label>
        </div>
        <div class="input-field select">
            <select id="select-fingerprint" data-binding-id="selectFingerprint" name="select-fingerprint"></select>
            <label for="select-fingerprint">Fingerprint</label>
        </div>
        <div class="input-field select">
            <select id="select-variant" data-binding-id="selectVariant" name="select-variant"></select>
            <label for="select-variant">Variant</label>
        </div>
        <div class="input-field select">
            <select id="select-map" data-binding-id="selectMap" name="select-map"></select>
            <label for="select-map">Map</label>
        </div>

        <p class="faerun-controls-header"><i class="material-icons">brush</i><span>LOOK</span></p>
        <div class="input-field select">
            <select id="select-view" data-binding-id="selectView" name="select-view">
                <option value="free">Free View</option>
                <option value="top">Top View</option>
                <option value="left">Left View</option>
                <option value="right">Right View</option>
                <option value="front">Front View</option>
                <option value="back">Back View</option>
            </select>
            <label for="select-view">View</label>
        </div>
        <p class="faerun-controls-header"><i class="material-icons">settings</i><span>SETTINGS</span></p>
        <p>
            <input type="checkbox" id="switch-fullscreen" data-binding-id="switchFullscreen" />
            <label for="switch-fullscreen">Fullscreen</label>
        </p>
        <p>
            <input type="checkbox" id="switch-color" data-binding-id="switchColor" />
            <label for="switch-color">Light Background</label>
        </p>
        <p>
            <input type="checkbox" id="large-preview" data-binding-id="largePreview" />
            <label for="large-preview">Overlay Molecule Preview</label>
        </p>
        <p>
            <input type="checkbox" id="coordinates-box" data-binding-id="coordinatesBox" />
            <label for="coordinates-box">Coordinates Box</label>
        </p>

        <p class="faerun-controls-header" style="margin-top:18px;"><i class="material-icons">build</i><span>TOOLS</span>
        </p>
        <div class="spacer"></div>
        <a href="#modal-share" id="button-share" data-binding-id="buttonShare"
            class="waves-effect waves-light btn-flat">
            <i class="material-icons left">share</i>Share
        </a>
        <br />
        <a href="#modal-search" id="button-search" data-binding-id="buttonSearch"
            class="waves-effect waves-light btn-flat">
            <i class="material-icons left">search</i>Search
        </a>
        <br />
        <a href="#modal-project" id="button-project" data-binding-id="buttonProject"
            class="waves-effect waves-light btn-flat">
            <i class="material-icons left">bubble_chart</i>Project
        </a>
        <br />
        <a href="#modal-knn" id="button-knn" data-binding-id="buttonKNN" class="waves-effect waves-light btn-flat">
            <i class="material-icons left">location_searching</i>KNN Search
        </a>
        <br />
        <a href="/tutorial.html" target="_blank" class="waves-effect waves-light btn-flat">
            <i class="material-icons left">help_outline</i>Help
        </a>
        <br />
        <a id="button-dl" data-binding-id="buttonDl" class="waves-effect waves-light btn-flat">
            <i class="material-icons left">photo_camera</i>Snap
        </a>

        <p class="faerun-controls-header"><i class="material-icons">poll</i><span>STATISTICS</span></p>
        <div class="spacer"></div>
        <p class="faerun-controls-small">Number of Compounds:&nbsp;<b id="stats-compounds"
                data-binding-id="statsCompounds"></b></p>
        <p class="faerun-controls-small">Number of Bins:&nbsp;<b id="stats-bins" data-binding-id="statsBins"></b></p>
        <div class="spacer"></div>
        <p class="faerun-controls-small">Bin Occupancy Histogram</p>
        <p class="faerun-controls-small">
            Avg:&nbsp;<b id="stats-avg" data-binding-id="statsAvg"></b>&nbsp;&nbsp;Min:&nbsp;<b id="stats-min"
                data-binding-id="statsMin"></b>&nbsp;&nbsp;Max:&nbsp;<b id="stats-max" data-binding-id="statsMax"></b>
        </p>
        <div class="stats">
            <canvas id="stats-canvas" data-binding-id="statsCanvas" width="280" height="200"></canvas>
            <p id="stats-x-label">Compound Count</p>
            <p id="stats-y-label">Number of Bins</p>
        </div>
    </div>
    <div class="page">
        <header>
            <div class="title">
                <span><img src="images/logo.png" />FAERUN</span>
                <span>&nbsp;</span>
                <span id="data-title" data-binding-id="dataTitle">No Data Loaded</span>
            </div>
            <div class="more">
            </div>
            <div class="hamburger">
                <a href="#" data-target="slide-out" class="sidenav-trigger white-text"><i
                        class="material-icons">menu</i></a>
            </div>
        </header>
        <main>
            <!-- The 3D canvas -->
            <canvas id="lore" data-binding-id="lore"></canvas>

            <div id="overlay-structure-container" data-binding-id="overlayStructureContainer" class="hidden">
                <canvas id="overlay-structure" data-binding-id="overlayStructure"></canvas>
            </div>

            <div id="viz">
                <a href="http://viz.gdb.tools">viz.gdb.tools</a>
            </div>
        </main>
    </div>

    <!-- Mobile Options -->
    <div class="fixed-action-btn">
        <a class="btn-floating btn-large">
            <i class="large material-icons">toys</i>
        </a>
        <ul>
            <li><a id="button-recenter" data-binding-id="buttonRecenter"
                    class="waves-effect waves-light btn-floating"><i class="material-icons">all_out</i></a></li>
            <li><a id="button-zoomin" data-binding-id="buttonZoomIn" class="waves-effect waves-light btn-floating"><i
                        class="material-icons">zoom_in</i></a></li>
            <li><a id="button-zoomout" data-binding-id="buttonZoomOut" class="waves-effect waves-light btn-floating"><i
                        class="material-icons">zoom_out</i></a></li>
            <li><a id="button-toggle-select" data-binding-id="buttonToggleSelect"
                    class="waves-effect waves-light btn-floating"><i class="material-icons">touch_app</i></a></li>
            <li><a id="button-select-hovered" data-binding-id="buttonSelectHovered"
                    class="waves-effect waves-light btn-floating"><i class="material-icons">add</i></a></li>
        </ul>
    </div>

    <!-- The left panel HUD -->
    <div id="faerun-panel" data-binding-id="faerunPanel" class="faerun-panel">
        <div class="flex-item">
            <div class="title"><i class="material-icons">camera</i>Hovered Bin Preview</div>
        </div>
        <div id="hover-structure" data-binding-id="hoverStructure" class="flex-item">
            <div class="hover-bin-size">
                <i class="material-icons">info_outline</i>
                <label>Bin Size:</label>
                <span id="hover-bin-size">-</span>
            </div>
            <canvas id="hover-structure-drawing" data-binding-id="hoverStructureDrawing" width="180"
                height="180"></canvas>
        </div>
        <div class="flex-item">
            <div class="title"><i class="material-icons">layers</i>Layers</div>
        </div>
        <div id="layers" data-binding-id="layers" class="flex-item">
            <div id="layer-container" data-binding-id="layerContainer"></div>
        </div>
        <div class="flex-item">
            <div class="title"><i class="material-icons">filter_list</i>Filters</div>
        </div>
        <div class="flex-item">
            <label>Depth Cutoff</label>
            <p class="range-field">
                <input id="slider-cutoff" data-binding-id="sliderCutoff" type="range" min="0" max="100" value="0"
                    tabindex="0">
            </p>
            <label>Color</label>
            <p class="range-field color-range">
                <input id="slider-color" data-binding-id="sliderColor" type="range" min="0.01" max="0.98" step="0.01"
                    value="0.01" tabindex="0">
            </p>
        </div>
        <div class="flex-item">
            <div class="title"><i class="material-icons">list</i>Selected Bins</div>
            <a id="download-bins" class="title-button tooltipped" data-tooltip="Download as CSV"><i
                    class="material-icons">file_download</i></a>
        </div>
        <div class="flex-item">
            <div id="select-container" data-binding-id="selectContainer"></div>
        </div>
    </div>

    <!-- The loader that is shown when data is transferred -->
    <div id="loader" data-binding-id="loader" class="hidden">
        <div id="loader-inner">
            <p id="loading-message" data-binding-id="loadingMessage"></p>
            <div class="progress">
                <div class="indeterminate" style="width:200px"></div>
            </div>
        </div>
    </div>

    <!-- Data overlays -->
    <span id="hover-indicator" data-binding-id="hoverIndicator" class="hidden"></span>

    <!-- Toasts -->
    <div id="toast-error" data-binding-id="toastError" class="mdl-js-snackbar mdl-snackbar">
        <div class="mdl-snackbar__text"></div>
        <button class="mdl-snackbar__action" type="button"></button>
    </div>

    <!-- Dialogs -->
    <div id="modal-share" class="modal modal-fixed-footer" style="height:300px;max-height:300px">
        <div class="modal-content flex">
            <h4 class="flex-item"><i class="material-icons">share</i>&nbsp;Share Current View</h4>
            <div class="flex-item">
                <p class="faerun-info">Copy and share the URL shown below.</p>
            </div>
            <div class="flex-item stretch">
                <div class="url-container input-field col s12">
                    <input type="text" placeholder="URL" id="url-dialog-project-input"
                        data-binding-id="urlDialogProjectInput">
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <a href="#!" class="modal-action modal-close waves-effect waves-red btn-flat ">Close</a>
        </div>
    </div>
    <div id="modal-search" class="modal modal-fixed-footer" style="height:90%;max-height:90%">
        <div class="modal-content flex">
            <h4 class="flex-item"><i class="material-icons">search</i>&nbsp;Search Compounds</h4>
            <div class="flex-item">
                <p class="faerun-info">You may enter one search query per line. A search query might include the ID, the
                    SMILES or the fingerprint of
                    a compound. Each query can return multiple matches. The search is case-sensitive (ABC is not equal
                    to abc).</p>
            </div>
            <div class="flex-item">
                <div class="row">
                    <div class="col s12">
                        <label for="textarea-search">Search Strings</label>
                    </div>
                </div>
            </div>
            <div class="flex-item stretch">
                <textarea id="textarea-search" data-binding-id="textareaSearch" class="faerun-textarea"
                    autofocus="autofocus"></textarea>
            </div>
        </div>
        <div class="modal-footer">
            <a href="#!" id="button-exec-search" data-binding-id="buttonExecSearch"
                class="modal-action modal-close waves-effect waves-green btn-flat">Search</a>
            <a href="#!" class="modal-action modal-close waves-effect waves-red btn-flat ">Cancel</a>
        </div>
    </div>

    <div id="modal-project" class="modal modal-fixed-footer" style="height:90%;max-height:90%">
        <div class="modal-content flex">
            <div class="title flex-item">Project Compounds</div>
            <div class="flex-item">
                <div class="row">
                    <div class="col s12">
                        <p class="faerun-info">
                            You may enter one compound per line. A compound has to be a valid SMILES string.
                        </p>
                    </div>
                </div>
                <div class="row">
                    <div id="colorpicker-dialog-project" data-binding-id="colorpickerDialogProject"
                        class="colorpicker-container input-field col s6">
                        <input type="text" placeholder="Color ..." id="colorpicker-dialog-project-input"
                            data-binding-id="colorpickerDialogProjectInput">
                    </div>
                    <div class="name-container input-field col s6">
                        <input type="text" placeholder="Name" id="name-dialog-project-input"
                            data-binding-id="nameDialogProjectInput">
                    </div>
                </div>
            </div>
            <div class="flex-item">
                <div class="row">
                    <div class="col s12">
                        <label for="textarea-project">SMILES to be projected</label>
                    </div>
                </div>
            </div>
            <div class="flex-item stretch">
                <textarea id="textarea-project" data-binding-id="textareaProject" class="faerun-textarea"
                    autofocus="autofocus"></textarea>
            </div>
        </div>
        <div class="modal-footer">
            <a href="#!" id="button-exec-project" data-binding-id="buttonExecProject"
                class="modal-action modal-close waves-effect waves-green btn-flat">Project</a>
            <a href="#!" class="modal-action modal-close waves-effect waves-red btn-flat ">Cancel</a>
        </div>
    </div>

    <div id="modal-knn" class="modal modal-fixed-footer">
        <div class="modal-content">
            <h4 class="flex-item"><i class="material-icons">location_searching</i>&nbsp;K-Nearest-Neighbour Search</h4>
            <div class="flex-item">
                <p class="faerun-info">Use this tool to search the k closest neighbours in the loaded database for each
                    data point in the selected layer.</p>
            </div>
            <div class="flex-item">
                <div class="row">
                    <div class="name-container input-field col s12">
                        <input type="text" placeholder="Number of Neighbours (k)" id="kKNN" data-binding-id="kKNN"
                            class="validate">
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <a href="#!" id="button-exec-knn" data-binding-id="buttonExecKNN"
                class="modal-action modal-close waves-effect waves-green btn-flat">Search</a>
            <a href="#!" class="modal-action modal-close waves-effect waves-red btn-flat ">Cancel</a>
        </div>
    </div>

    <div id="modal-first-visit" class="modal modal-fixed-footer">
        <div class="modal-content">
            <h4 class="flex-item"><i class="material-icons">info_outline</i>&nbsp;Welcome to Faerun</h4>
            <div class="flex-item">
                <p class="faerun-info">This website uses cookies to ensure you get the best experience on our website.
                    <a href="http://cookiesandyou.com/">Learn more</a></p>
                <p class="faerun-info">If you are using <b>Internet Explorer</b>, please switch to Edge, Chrome or
                    Firefox. IE will not display all structures and does not support range sliders.</a></p>
            </div>
            <div class="flex-item">
                <div class="row">
                    <div class="col s12">
                        <p>If you wish to use advanced features such as custom data projection and KNN searching, please
                            consider reading the <a href="/tutorial.html" target="_blank">full tutorial</a>.</p>
                    </div>
                    <div class="col s4">
                        <img src="./images/main-menu.png" style="width: 100%"></img>
                    </div>
                    <div class="col s8">
                        <p>
                            <b>1.</b> To get started, open the main menu by clicking the hamburger menu to the top right
                            of the screen.
                        </p>
                        <p>
                            <b>2.</b> Select a database from the select element. All available fingerprints will be
                            displayed once a database is selected.
                        </p>
                        <p>
                            <b>3.</b> Select a variant (the positions of the vertices). Available maps will be loaded.
                        </p>
                        <p>
                            <b>4.</b> Select a map (the color of the vertices). The menu closes automatically after
                            selecting a map.
                        </p>
                    </div>
                </div>
                <div class="row">
                    <div class="col s4">
                        <img src="./images/balls.png" style="width: 100%"></img>
                    </div>
                    <div class="col s8">
                        <p>
                            <b>5.</b> You then may explore the loaded dataset. Whenever you hover a datapoint, a preview
                            is shown to the top left.
                        </p>
                        <p>
                            <b>6.</b> Data points can be selected by double-clicking. They are then added to the
                            selected container on the left.
                        </p>
                    </div>
                </div>
                <div class="row">
                    <div class="col s4">
                        <img src="./images/selected.png" style="width: 100%"></img>
                    </div>
                    <div class="col s8">
                        <p>
                            <b>7.</b> Selected data points show up in the bin container. They can be removed or centered
                            upon clicking the respective button.
                        </p>
                        <p>
                            <b>8.</b> With SureChEMBL data, a data point (bin) can further explored by clicking it. The
                            details will be openend in a new tab (might take a couple of seconds).
                        </p>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal-footer">
            <a href="#!" class="modal-action modal-close waves-effect waves-red btn-flat ">Let's Start</a>
        </div>
    </div>

    <!-- Templates -->
    <script id="selected-bin-template" type="text/x-handlebars-template">
            <div id="selected-bin-item-{{layer}}-{{id}}" 
             class="item" data-hue="{{hue}}" data-color="{{color}}">
                <canvas id="select-structure-drawing-{{layer}}-{{id}}" width="50" height="50"></canvas>
                <a href="#" class="closer" id="bin-closer-{{layer}}-{{id}}"><i class="material-icons">close</i></a>
                <a href="#" class="center" data-layer="{{layer}}" data-id="{{id}}"
                   id="bin-center-{{layer}}-{{id}}">
                    <i class="material-icons">all_out</i>
                </a>
                <span class="size">Bin Size: <b id="select-bin-size-{{layer}}-{{id}}"></b></span>
            </div>
        </script>

    <script id="layer-template" type="text/x-handlebars-template">
            <div id="layer-{{id}}" class="item">
                <div class="color" style="background-color: {{color}}"></div>
                <div class="name">{{name}}</div>
                <div class="checkbox-container">
                    <input id="checkbox-visible-{{id}}" class="checkbox" name="checkbox-visible-{{id}}" type="checkbox">
                    <label for="checkbox-visible-{{id}}" class="checkbox-label"></label>
                </div>
                <div class="radio-container">
                    {{#if current}}
                        <input id="radio-current-{{id}}" value="{{id}}" class="radio radio-current-layer" name="radio-current-layer" type="radio" checked="checked">
                    {{else}}
                        <input id="radio-current-{{id}}" value="{{id}}" class="radio radio-current-layer" name="radio-current-layer" type="radio"> 
                    {{/if}}
                    <label for="radio-current-{{id}}" class="radio-label"></label>
                </div>
            </div>
        </script>

    <script src="config.js"></script>
    <script src="scripts/jsonp.js"></script>
    <script src="scripts/common.js"></script>
    <script src="scripts/index.js"></script>

    <script src="libs/materialize/materialize.min.js"></script>
    <script>
        // Initialization stuff for materialize.css
        document.addEventListener('DOMContentLoaded', function () {
            var elems = document.querySelectorAll('.sidenav');
            var instances = M.Sidenav.init(elems, {
                menuWidth: 300,
                edge: 'right',
                closeOnClick: true,
                draggable: true
            });
        });

        (function ($) {
            $(function () {
                $('.sidenav').sidenav();

                $('select').formSelect();

                $('.tooltipped').tooltip({ delay: 50 });

                $('.modal').modal({
                    startingTop: '2%',
                    endingTop: '5%'
                });

                if (firstImpression()) {
                    $('#modal-first-visit').modal('open');
                }
            });
        })(jQuery);
    </script>
</body>

</html>